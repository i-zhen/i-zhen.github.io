<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>复杂系统真相——软件篇 | Z.Y. ☯ Cosmos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="最近国内很不巧，赶上了新型冠状病毒SARS-Cov-2大爆发，也算是得益于此我获得了自打从英国回国入职后久违的真正意义上的小长假。当然，按照国内科技私企的特点免不了之后会做出让我问候他家祖先的弥补性措施来。不多扯题外话，主要就复杂的系统谈一谈我的个人浅见。 亘古至今，从旧石器时代远古人类的群居生活到新石器时代晚期部落的建立再到现代信息化的社会，人造复杂系统经历了至少成千上万年的演化在生活中已无法离">
<meta property="og:type" content="article">
<meta property="og:title" content="复杂系统真相——软件篇">
<meta property="og:url" content="https://izhen.me/2020/02/12/complexity_truth/index.html">
<meta property="og:site_name" content="Z.Y. ☯ Cosmos">
<meta property="og:description" content="最近国内很不巧，赶上了新型冠状病毒SARS-Cov-2大爆发，也算是得益于此我获得了自打从英国回国入职后久违的真正意义上的小长假。当然，按照国内科技私企的特点免不了之后会做出让我问候他家祖先的弥补性措施来。不多扯题外话，主要就复杂的系统谈一谈我的个人浅见。 亘古至今，从旧石器时代远古人类的群居生活到新石器时代晚期部落的建立再到现代信息化的社会，人造复杂系统经历了至少成千上万年的演化在生活中已无法离">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-12T12:15:45.000Z">
<meta property="article:modified_time" content="2020-02-15T12:15:13.255Z">
<meta property="article:author" content="Zhen Yi">
<meta property="article:tag" content="复杂度">
<meta property="article:tag" content="复杂系统">
<meta property="article:tag" content="软件">
<meta property="article:tag" content="世界">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@soczhenyi">
  
    <link rel="alternate" href="/atom.xml" title="Z.Y. ☯ Cosmos" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Z.Y. ☯ Cosmos</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Powered by Disqus, scientific surfing for access</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="http://ec2-13-231-164-97.ap-northeast-1.compute.amazonaws.com">λ</a>
        
          <a class="main-nav-link" href="/lab">About</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="https://resume.izhen.me">Resume</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="https://github.com/i-zhen">Github</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://izhen.me"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-complexity_truth" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/02/12/complexity_truth/" class="article-date">
  <time class="dt-published" datetime="2020-02-12T12:15:45.000Z" itemprop="datePublished">2020-02-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Blog/">Blog</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      复杂系统真相——软件篇
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近国内很不巧，赶上了新型冠状病毒<code>SARS-Cov-2</code>大爆发，也算是得益于此我获得了自打从英国回国入职后久违的真正意义上的小长假。当然，按照国内科技私企的特点免不了之后会做出让我问候他家祖先的弥补性措施来。不多扯题外话，主要就复杂的系统谈一谈我的个人浅见。</p>
<p>亘古至今，从旧石器时代远古人类的群居生活到新石器时代晚期部落的建立再到现代信息化的社会，人造复杂系统经历了至少成千上万年的演化在生活中已无法离开、无处不在：</p>
<ul>
<li>大城市本身</li>
<li>交通网络</li>
<li>通讯系统</li>
<li>大飞机、航空母舰等大型单体机械设备</li>
<li>社会公务系统等</li>
</ul>
<p>除上述的不完整的例子外，还有更神奇的数十亿年演化的自然体系：</p>
<ul>
<li>地球生态系统</li>
<li>行星系统等</li>
</ul>
<p>我不是研究自然科学的专家，在此也不谈系统设计（其实系统设计更值得玩味），主要就我相对比较熟悉的复杂软件系统给出一点判断和理解。直到撰文的此刻，再有两个月我工龄将满3年，在2家公司打工，先后经手了5个项目。姑且不论5个商业性质的项目和50个是否会有本质性的区别，一些很容易发现的规律还是大差不差。</p>
<span id="more"></span>

<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><h3 id="软件系统的特征"><a href="#软件系统的特征" class="headerlink" title="软件系统的特征"></a>软件系统的特征</h3><p>这里的软件是指代功能完备，可独立运行的非单一代码片段的程序集。最小单位显然就是单文件的软件，但是单一文件的软件可以非常复杂，比如纯C实现的「猫版马里奥」，下面的例子是<code>C++</code>实现的最小的软件之一：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Hello World&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>功能确实非常简单，也算是个软件了。而软件系统一般就比上述复杂了，起码功能模块不少于2个或以上，讨论软件系统的定义不是特别有意义，这里就当读者都已经理解系统的定义。一些例子：操作系统、网络系统。</p>
<h3 id="战略开发与战术开发的特点"><a href="#战略开发与战术开发的特点" class="headerlink" title="战略开发与战术开发的特点"></a>战略开发与战术开发的特点</h3><p>战术开发通常着眼与眼前，见效快，但是对于未来的投入影响小。战略开发则有延迟满足的特点，一般是对于未来的投资。我们这里不聊具体的软件设计，读者请自行参考《A Philosopy of Software Design》</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 设计上的复杂也不可避免，假设下面两个面积接近的矩形的宽度代表接口复杂度，深度代表实现复杂度</span></span><br><span class="line"><span class="comment"> * 从用户体验讲，A好过B。代价却是更复杂的实现。</span></span><br><span class="line"><span class="comment"> *  _____               ___________________</span></span><br><span class="line"><span class="comment"> * |     |             |                   |</span></span><br><span class="line"><span class="comment"> * |     |             |                   |</span></span><br><span class="line"><span class="comment"> * |     |             |                   |</span></span><br><span class="line"><span class="comment"> * |     |             |___________________|</span></span><br><span class="line"><span class="comment"> * |     |                      (B)</span></span><br><span class="line"><span class="comment"> * |     |</span></span><br><span class="line"><span class="comment"> * |     |</span></span><br><span class="line"><span class="comment"> * |_____|</span></span><br><span class="line"><span class="comment"> *   (A)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<h3 id="一些基本定义"><a href="#一些基本定义" class="headerlink" title="一些基本定义"></a>一些基本定义</h3><ol>
<li>软件系统<strong>代码复杂度</strong>（不是算法复杂度）的简单定义：定性的看，设复杂等级的集合K = {游戏复杂指数集合、通信软件复杂指数集合、操作系统复杂指数集合…}，对于软件系统（以后简称系统）的功能数量S，与代码总行数L。有L/S正比与K。这里K是针对不同软件类型的集合，因为游戏和OS的复杂度很可能不同，而用Python和C++开发也会有很大的不同，虽然相对复杂度没有区别。</li>
<li>系统<strong>代码质量好坏</strong>的定义：一个功能在可用、可信、可扩展、可靠、效率都完全一致的情况下，代码简洁的实现好过代码冗长的实现。</li>
<li>关键技术突破与消耗时间呈正相关：一个目标任务，在开发期间不会遇到需求变更时，长时间的开发总不会比短时间开发的质量更差。因为如果用1个单位时间可以完成需求，2个或更长单位时间即便什么都不做也不会在关键技术上更差，最差是保持持平（技术含量与代码优美无关）。</li>
</ol>
<h2 id="Shit-Mountain-定律"><a href="#Shit-Mountain-定律" class="headerlink" title="Shit Mountain 定律"></a>Shit Mountain 定律</h2><h3 id="SM第一定律"><a href="#SM第一定律" class="headerlink" title="SM第一定律"></a>SM第一定律</h3><blockquote>
<p>任何一个在空间约束差，项目开发时间约束强的系统，都不可避免的存在部分模块或全局代码为屎山的情况。</p>
</blockquote>
<p>说明如下：</p>
<ul>
<li>空间约束差：不限制行数多少和系统size大小，空间上的限制低。大多数情况下因为资源过剩或者根本无法限制，然而另一方面，过分强调短码会影响可读性，走上另一种极端，具体参考《短码之美》</li>
<li>时间约束强：本来不加班做半年的项目，要求加班做一个月，会让人时常burnout的情况</li>
</ul>
<p>解释：代码的简洁优雅是需要时间雕琢的，实现目标的时间有限，宝贵的时间通常会优先解决关键问题，而过强的时间约束会导致无法投入更多的时间于代码本身，设计模式滥用，Hardcode，逻辑混乱的情况屡见不鲜。有时候短小精美的代码需要花费的时间会长过不假思索的冗长代码。</p>
<h3 id="SM第二定律"><a href="#SM第二定律" class="headerlink" title="SM第二定律"></a>SM第二定律</h3><blockquote>
<p>系统的复杂在于问题的引入，假设在某环境下关键性的A问题会导致系统复杂，在另一种环境中不存在A问题。那么另一种环境中一定会有有别于A问题的B问题也会导致系统复杂，总会有难以攻克的问题存在。</p>
</blockquote>
<p>解释：假设用没有标准算法库的纯C语言实现从一组大数据中进行增删改查操作，只是完成增删改查的基本操作用很朴素的代码就可以解决。现在如果同时对效率有要求（A问题），那么不可避免的要引入索引，实现方式有很多种，无论红黑树、B树亦或其他的算法数据结构，都比朴素的代码复杂。如果现在换成C++或者Python实现（另一种环境），虽然有现成的容器（A问题不存在了），但是为了解耦合增加代码复用，不可避免的要引入设计模式（B问题），其他情况类似，问题是复杂的。</p>
<h3 id="SM第三定律"><a href="#SM第三定律" class="headerlink" title="SM第三定律"></a>SM第三定律</h3><blockquote>
<p>复杂是主动且被动蕴含的，人为的设计、代码改进走错了方向、团队协作对齐出现问题等都会引入复杂，有不得不解决的难题时也会引入复杂。</p>
</blockquote>
<p>解释：无论想不想，除非做的系统毫无技术挑战，不然主动或被动引入复杂在所难免。</p>
<h3 id="总定律"><a href="#总定律" class="headerlink" title="总定律"></a>总定律</h3><blockquote>
<p>根据SM三定律，任何有市场存在价值的商业系统，若无专门的时间投入到代码质量本身，屎山存在的几率接近100%。</p>
</blockquote>
<p>解释：商业系统的特点是要面对市场竞争，所以开发时间有限，这满足第一定律；如果商业系统可以在市场竞争中存活，那么其必有关键技术支撑，这满足第三定律包含复杂因素；因为有复杂因素，第二定律生效，复杂的问题不会凭空消失，从而带来代码开发上的问题。</p>
<p>另一方面，大多数公司限于人员水平或激烈的市场竞争的制约，都采用战术开发的方式。因为对于用户而言，源代码优美与否是不可见的且对于功能影响小的，毕竟维护和扩展的压力在于开发者。所以代码本身的质量上的投资特征是投入高、产出小，并不经济。这就注定造成大部分商用代码的质量存在问题，影响的方面也很多，特别是生命周期短的商用代码。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>市场浮躁往往是屎山堆积的借口，在商用代码中也有类似「VMWare」这样正面的例子。结合我自己的经验，迄今为止我摸过5个项目，很幸运有一个项目是从0开始做的，这就更好的帮助我总结了上述定律，如果碰别人的二手代码带来了很多负面影响的借口成立的情况下，自己从0开始写是不是就能一定写好呢？答案已经在前面给出了。</p>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ol>
<li>首位永远是好的设计，可以避免很多问题，脑袋决定屁股，定律3</li>
<li>工具链的改进，比如一些Web的业务代码，如果在速度上不是特别苛求的话，Py比C++好。但是这也只能优化不能根除问题，定律2</li>
<li>最奢侈的方案：足够的时间去雕琢，投资于未来，定律1。不太适合竞争激烈的商业项目</li>
<li>你能想到的任何方案——宏观角度：选择好的市场环境、有优秀决策者、高品质团队的公司；微观角度：选择设计良好、代码整洁的项目等</li>
<li>没有十全十美，必要时刻该佛就佛</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><h3 id="本文的参考"><a href="#本文的参考" class="headerlink" title="本文的参考"></a>本文的参考</h3><ul>
<li>自身的开发经历</li>
<li>《A Philosopy of Software Design》</li>
<li>《短码之美》</li>
<li><a target="_blank" rel="noopener" href="https://yiming.dev/clipping/2018/12/24/no_code_is_better_than_no-code/">No Code is Better Than No-Code</a></li>
<li><a target="_blank" rel="noopener" href="https://www.techug.com/post/mess-code.html">有着1万个全局变量的一大坨代码</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=RCCigccBzIU">Dijsktra采访的</a> <a target="_blank" rel="noopener" href="https://www.yinwang.org/blog-cn/2014/02/18/dijkstra-interview">视频</a></li>
</ul>
<h3 id="推荐尝试"><a href="#推荐尝试" class="headerlink" title="推荐尝试"></a>推荐尝试</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=2ahUKEwir84y7lsznAhVIE6YKHZ9KAHUQFjAAegQIARAB&url=https://medium.com/@balidani/cities-skylines-is-turing-complete-e5ccf75d1c3a&usg=AOvVaw2ivB_vd7obnyuYMxX_3mnv">Cities: Skylines is Turing Complete</a></li>
<li>Minecraft的红石系统</li>
<li><a target="_blank" rel="noopener" href="https://www.effectiveengineer.com/book">The Effective Engineer</a></li>
<li><a target="_blank" rel="noopener" href="http://shop.oreilly.com/product/0636920047391.do">Programming Beyond Practices</a></li>
<li>在大厂做个好的螺丝钉，能学到很多。其实我本人也不喜欢，但是有时也无可奈何</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://izhen.me/2020/02/12/complexity_truth/" data-id="cktfbjvg8003imidx6t9lfd2c" data-title="复杂系统真相——软件篇" class="article-share-link">Share</a>
      
        <a href="https://izhen.me/2020/02/12/complexity_truth/#disqus_thread" class="article-comment-link">Comments</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%96%E7%95%8C/" rel="tag">世界</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%8D%E6%9D%82%E5%BA%A6/" rel="tag">复杂度</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%A4%8D%E6%9D%82%E7%B3%BB%E7%BB%9F/" rel="tag">复杂系统</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/05/20/bidirectional_preview/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          双向预览热更新技术
        
      </div>
    </a>
  
  
    <a href="/2020/01/25/work3years/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">工作3年会遇到什么事</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Zhen Yi<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
      <br>
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="site-uv">用户访问: <span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
      <span class="site-pv">本站访问: <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a target="_blank" rel="noopener" href="http://ec2-13-231-164-97.ap-northeast-1.compute.amazonaws.com" class="mobile-nav-link">λ</a>
  
    <a href="/lab" class="mobile-nav-link">About</a>
  
    <a target="_blank" rel="noopener" href="https://resume.izhen.me" class="mobile-nav-link">Resume</a>
  
    <a target="_blank" rel="noopener" href="https://github.com/i-zhen" class="mobile-nav-link">Github</a>
  
</nav>
    
<script>
  var disqus_shortname = 'izhen';
  
  var disqus_url = 'https://izhen.me/2020/02/12/complexity_truth/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>