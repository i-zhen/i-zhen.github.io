<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>DApp一日通——web3.js、Truffle与Dfinity篇 | Z.Y. ☯ Cosmos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="本文在Truffle框架的基础上给出一个可快速上手DApp的教程，并非工业化流程，其中对于真实的生产环境做了大量的精简，仅保留最关键的几个部分，对于初学者足以了解一个DApp的开发工作流程，但是对于工业级生产则远远不够。这里仅作为一个入门来一窥DApp的基本概念。">
<meta property="og:type" content="article">
<meta property="og:title" content="DApp一日通——web3.js、Truffle与Dfinity篇">
<meta property="og:url" content="https://izhen.me/2022/05/23/2022_DApp/index.html">
<meta property="og:site_name" content="Z.Y. ☯ Cosmos">
<meta property="og:description" content="本文在Truffle框架的基础上给出一个可快速上手DApp的教程，并非工业化流程，其中对于真实的生产环境做了大量的精简，仅保留最关键的几个部分，对于初学者足以了解一个DApp的开发工作流程，但是对于工业级生产则远远不够。这里仅作为一个入门来一窥DApp的基本概念。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://izhen.me/image/truffle/dapp.svg">
<meta property="og:image" content="https://izhen.me/image/truffle/sol.png">
<meta property="og:image" content="https://izhen.me/image/truffle/migrate.png">
<meta property="og:image" content="https://izhen.me/image/truffle/config.png">
<meta property="og:image" content="https://izhen.me/image/truffle/web3js.png">
<meta property="article:published_time" content="2022-05-23T12:53:47.000Z">
<meta property="article:modified_time" content="2022-05-25T14:17:21.127Z">
<meta property="article:author" content="Zhen Yi">
<meta property="article:tag" content="Haskell">
<meta property="article:tag" content="web 3.0">
<meta property="article:tag" content="Solidity">
<meta property="article:tag" content="Truffle">
<meta property="article:tag" content="web3.js">
<meta property="article:tag" content="DApp">
<meta property="article:tag" content="x071">
<meta property="article:tag" content="Geth">
<meta property="article:tag" content="Ethereum">
<meta property="article:tag" content="Dfinity">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://izhen.me/image/truffle/dapp.svg">
<meta name="twitter:creator" content="@soczhenyi">
  
    <link rel="alternate" href="/atom.xml" title="Z.Y. ☯ Cosmos" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Z.Y. ☯ Cosmos</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Powered by Disqus, scientific surfing for access</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="http://sweetpotato.ai">λ</a>
        
          <a class="main-nav-link" href="/lab">About</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="https://resume.izhen.me">Resume</a>
        
          <a class="main-nav-link" target="_blank" rel="noopener" href="https://github.com/i-zhen">Github</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://izhen.me"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2022_DApp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/05/23/2022_DApp/" class="article-date">
  <time class="dt-published" datetime="2022-05-23T12:53:47.000Z" itemprop="datePublished">2022-05-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/BLOG/">BLOG</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      DApp一日通——web3.js、Truffle与Dfinity篇
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>本文在<a href="">Truffle</a>框架的基础上给出一个可快速上手DApp的教程，并非工业化流程，其中对于真实的生产环境做了大量的精简，仅保留最关键的几个部分，对于初学者足以了解一个DApp的开发工作流程，但是对于工业级生产则远远不够。这里仅作为一个入门来一窥<code>DApp</code>的基本概念。</p>
<span id="more"></span>

<h3 id="DApp基本技术栈"><a href="#DApp基本技术栈" class="headerlink" title="DApp基本技术栈"></a>DApp基本技术栈</h3><p>一个DApp和常规的App最大的区别就是存在与去中心的区块链进行合约交互的环节，在以太坊区块链上可以运行的App实际上就是指合约。一个仅有合约的应用架构显然是很局限的，所以所谓的DApp通常都不是纯粹的去中心，其开发体系与<code>web2</code>的应用基本无异，最大的不同除了链上合约调用外，服务端也成为了可选的部分。</p>
<p><img src="/image/truffle/dapp.svg" alt="DApp Architecture"></p>
<p>关键组件:</p>
<ol>
<li>Web3 Provider: 负责与区块链通信的角色，可以对合约进行调用。常见的包含: MetaMask、web3.js等<ul>
<li>Relay: Provider背后真正负责与区块链交互的服务器集群，web3的XaaS；本地练习暂时不必要 </li>
</ul>
</li>
<li>Smart Contract: Ethereum Virtual Machine上运行的合约bytecode代码，提供图灵完备的计算能力，可以做信息储存、NFT资产发行、投票等<ul>
<li>Oracle: 智能合约背后与外部世界建立联系的方式，简单说可以看成API，在链上通过Oracle Contract完成数据交互</li>
</ul>
</li>
<li>UI: DApp的关键组件，方便用户操作。就用React/Vue即可</li>
<li>Server: 不是必要的，比如Uniswap。对于特殊需要的，比如数据追踪，可以拉起一个后端做只读服务；另外，对于涉及到钱包登陆的DApp，为了安全性考虑也会将一些验证逻辑封装在后端</li>
<li>web3常用编程语言: Solidity，Rust，Go，JS Family(TypeScript)。性能够用的情况下，尽可能选用开发效率高的，人生苦短，兵贵神速</li>
</ol>
<h3 id="安装与初始化本地Ethereum"><a href="#安装与初始化本地Ethereum" class="headerlink" title="安装与初始化本地Ethereum"></a>安装与初始化本地Ethereum</h3><p>我们首先要在本地搭建一个私有链进行测试用，也就是自动mining的区块链调试网络。使用<code>homebrew</code>安装以太坊，命令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> brew tap ethereum/ethereum</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> brew install ethereum</span></span><br></pre></td></tr></table></figure>

<p>而后，我们需要在一个以太坊目录(用户自定)下，创建名为<code>genesis.json</code>的文件，并填写如下内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;config&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;chainId&quot;</span>: <span class="number">33</span>,</span><br><span class="line">    <span class="attr">&quot;homesteadBlock&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;eip150Block&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;eip155Block&quot;</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;eip158Block&quot;</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;nonce&quot;</span>: <span class="string">&quot;0x0000000000000033&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;timestamp&quot;</span>: <span class="string">&quot;0x0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;parentHash&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;gasLimit&quot;</span>: <span class="string">&quot;0x8000000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;difficulty&quot;</span>: <span class="string">&quot;0x100&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;mixhash&quot;</span>: <span class="string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;coinbase&quot;</span>: <span class="string">&quot;0x3333333333333333333333333333333333333333&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;alloc&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述内容定义了创世区块的基本属性，其含义为：</p>
<p>接下来我们对于此私链来做一点测试训练，首先启动区块链进入dev模式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ geth --datadir data init genesis.json</span><br><span class="line">$ geth --dev console 2&gt;&gt; geth-log</span><br></pre></td></tr></table></figure>

<p>一些常用的指令与示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Geth JavaScript console!</span><br><span class="line"></span><br><span class="line">instance: Geth/v1.10.9-stable/darwin-amd64/go1.17.1</span><br><span class="line">coinbase: 0x405f684ab16943a63cf462e0826e247116158eae</span><br><span class="line">at block: 0 (Thu Jan 01 1970 08:00:00 GMT+0800 (CST))</span><br><span class="line"> datadir: </span><br><span class="line"> modules: admin:1.0 clique:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</span><br><span class="line"></span><br><span class="line">To exit, press ctrl-d or type exit</span><br><span class="line"></span><br><span class="line"># 查看区块高度，当前高度是0，只有创世区块</span><br><span class="line">&gt; eth.blockNumber</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"># 返回钱包管理的账户地址列表</span><br><span class="line">&gt; eth.accounts</span><br><span class="line">[&quot;0x405f684ab16943a63cf462e0826e247116158eae&quot;]</span><br><span class="line"></span><br><span class="line"># 使用newAccount指令创建账户，参数为账户的锁定密码，创建2个试验账户</span><br><span class="line">&gt; personal.newAccount(&#x27;123456&#x27;)</span><br><span class="line">&quot;0xbe23c61668a1412b2db768c9bc114e416beb8d4b&quot;</span><br><span class="line">&gt; personal.newAccount(&#x27;123456&#x27;)</span><br><span class="line">&quot;0x741c8176606257421cef9eeb2e64c5fb7785d982&quot;</span><br><span class="line"># 可以为账户设置别名</span><br><span class="line">&gt; user1=eth.accounts[0]</span><br><span class="line">&quot;0x405f684ab16943a63cf462e0826e247116158eae&quot;</span><br><span class="line">&gt; user2=eth.accounts[1]</span><br><span class="line">&quot;0xbe23c61668a1412b2db768c9bc114e416beb8d4b&quot;</span><br><span class="line"></span><br><span class="line"># 查看余额，通常默认地址有很多初始化的token，新建账户则为0</span><br><span class="line">&gt; eth.getBalance(user1)</span><br><span class="line">1.15792089237316195423570985008687907853269984665640564039457584007913129639927e+77</span><br><span class="line">&gt; eth.getBalance(user2)</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"># 解锁账户，默认密码为空</span><br><span class="line"># 解锁后，发起转账</span><br><span class="line">&gt; personal.unlockAccount(user1)</span><br><span class="line">Unlock account 0x405f684ab16943a63cf462e0826e247116158eae</span><br><span class="line">Passphrase: </span><br><span class="line">true</span><br><span class="line">&gt; eth.sendTransaction(&#123;from:user1,to:user2,value:web3.toWei(3,&quot;ether&quot;)&#125;)</span><br><span class="line">&quot;0x91cf001e2eb691186522349c12e6f64f1993104d1ffd4a729bf0a02daec405d5&quot;</span><br><span class="line"></span><br><span class="line">#从user1向user2转账3个以太币</span><br><span class="line">#命令运行后，提交交易立马回出发挖矿</span><br><span class="line">eth.sendTransaction(&#123;from:user1,to:user2,value:web3.toWei(3,&quot;ether&quot;)&#125;)</span><br><span class="line"></span><br><span class="line"># miner默认为自动挖矿，有交易才会挖矿</span><br><span class="line">&gt; miner.stop()</span><br><span class="line">&gt; miner.start()</span><br><span class="line"></span><br><span class="line"># 查看矿工的地址</span><br><span class="line">&gt; eth.coinbase</span><br><span class="line"></span><br><span class="line"># 设置矿工地址</span><br><span class="line">&gt; miner.setEtherbase(eth.coinbase)</span><br></pre></td></tr></table></figure>

<h3 id="智能合约的编写"><a href="#智能合约的编写" class="headerlink" title="智能合约的编写"></a>智能合约的编写</h3><p>本地开发，推荐VSCode配合插件的形式。在线开发，可以尝试<a href="">Remix IDE</a>。这里我们需要尝试写一点<code>Solidity</code>，有关内容可以参考这个<a href="https://izhen.me/2022/05/15/2022_solidity/">Tutorial</a>。我们将会使用下面的测试合约与本地的<code>Geth</code>进行交互：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.8</span><span class="number">.7</span>;</span><br><span class="line"></span><br><span class="line">contract Test &#123;</span><br><span class="line">    string private content;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">string calldata _msg</span>) <span class="title">public</span> </span>&#123;</span><br><span class="line">        content = _msg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"></span>) <span class="title">view</span> <span class="title">public</span> <span class="title">returns</span>(<span class="params">string memory</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Truffle-Suite"><a href="#Truffle-Suite" class="headerlink" title="Truffle Suite"></a>Truffle Suite</h3><p>我们使用<code>Truffle</code>框架来集成智能合约。在给定的架构内对Solidity进行编写、编译、部署等相关的工作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g truffle # 安装truffle</span><br><span class="line">$ mkdir test</span><br><span class="line">$ cd test</span><br><span class="line">$ truffle init           # 新建一个truffle项目</span><br></pre></td></tr></table></figure>

<p>在<code>contracts</code>文件夹下创建我们自己的合约：</p>
<p><img src="/image/truffle/sol.png" alt="Solidity"></p>
<p>在<code>migrations</code>文件夹下编写部署脚本：</p>
<p><img src="/image/truffle/migrate.png" alt="部署JS"></p>
<p>最后修改<code>truffle-config.js</code>指定部署配置（注意：图中的gas太高会导致部署失败，设置为3000000即可）：</p>
<p><img src="/image/truffle/config.png" alt="truffle_config.js"></p>
<p>在部署前需要先启动<code>Geth</code>注意要包含<code>--allow-insecure-unlock</code>并解锁账户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ geth --datadir data0 --networkid 1108  --networkid 786 --http --http.api &#x27;web3,eth,net,debug,personal&#x27; --http.corsdomain &#x27;*&#x27; --dev --allow-insecure-unlock console 2&gt;&gt;eth_log</span><br><span class="line">$ &gt;personal.unlockAccount(user)</span><br><span class="line">$ &gt;miner.start()</span><br></pre></td></tr></table></figure>

<p>使用如下指令编译与部署合约：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ truffle compile # 编译</span><br><span class="line">$ truffle migrate # 部署</span><br></pre></td></tr></table></figure>

<p>我们可以得到如下结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Compiling your contracts...</span><br><span class="line">===========================</span><br><span class="line">&gt; Everything is up to date, there is nothing to compile.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Starting migrations...</span><br><span class="line">======================</span><br><span class="line">&gt; Network name:    &#x27;development&#x27;</span><br><span class="line">&gt; Network id:      786</span><br><span class="line">&gt; Block gas limit: 11500000 (0xaf79e0)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">2_deploy_contracts.js</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">   Deploying &#x27;Test&#x27;</span><br><span class="line">   ----------------</span><br><span class="line">   &gt; transaction hash:    0x11253af06954ee68476d0edb6359f636b1af68dc867bf567cf7790f991150378</span><br><span class="line">   &gt; Blocks: 0            Seconds: 0</span><br><span class="line">   &gt; contract address:    0x8DEd5fEb94f27b8DBEeF8894100C841e4b8478Ea</span><br><span class="line">   &gt; block number:        3</span><br><span class="line">   &gt; block timestamp:     1653303134</span><br><span class="line">   &gt; account:             0x373241c533AF160A2129b4eE784DeDA383840C52</span><br><span class="line">   &gt; balance:             115792089237316195423570985008687907853269984665640564039457.583576222027150341</span><br><span class="line">   &gt; gas used:            262922 (0x4030a)</span><br><span class="line">   &gt; gas price:           3.174859949 gwei</span><br><span class="line">   &gt; value sent:          0 ETH</span><br><span class="line">   &gt; total cost:          0.000834740527510978 ETH</span><br><span class="line"></span><br><span class="line">   &gt; Saving migration to chain.</span><br><span class="line">   &gt; Saving artifacts</span><br><span class="line">   -------------------------------------</span><br><span class="line">   &gt; Total cost:     0.000834740527510978 ETH</span><br><span class="line"></span><br><span class="line">Summary</span><br><span class="line">=======</span><br><span class="line">&gt; Total deployments:   2</span><br><span class="line">&gt; Final cost:          0.001679010277510978 ETH</span><br></pre></td></tr></table></figure>

<h4 id="调用已经部署的合约"><a href="#调用已经部署的合约" class="headerlink" title="调用已经部署的合约"></a>调用已经部署的合约</h4><p>使用现有的<code>web3</code>相关库在DApp中调用合约很方便，这里我们先用<code>truffle</code>控制台来进行合约的调用演示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># 启动控制台</span><br><span class="line">$ truffle <span class="built_in">console</span></span><br><span class="line"></span><br><span class="line"># 拿到合约实例</span><br><span class="line">$ <span class="keyword">let</span> ins = <span class="keyword">await</span> Test.deployed()</span><br><span class="line"></span><br><span class="line">truffle(development)&gt; <span class="keyword">let</span> accounts = <span class="keyword">await</span> web3.eth.getAccounts()</span><br><span class="line">truffle(development)&gt; accounts</span><br><span class="line">[</span><br><span class="line">  <span class="string">&#x27;0x373241c533AF160A2129b4eE784DeDA383840C52&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;0x9f8917fc0e9ebCf86e4DDc901775Ece98C08A44a&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 调用合约中的方法</span><br><span class="line">truffle(development)&gt; ins.set(<span class="string">&quot;hello truffle&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">tx</span>: <span class="string">&#x27;0x86248c6f2cbf4ac864087d3cb140d703b3da2ba392791bb040bc5bd23abef3ea&#x27;</span>,</span><br><span class="line">  <span class="attr">receipt</span>: &#123;</span><br><span class="line">    <span class="attr">blockHash</span>: <span class="string">&#x27;0xfb8095fb11e8fa170f00d7ed50d72a1d3f51d690b1ac1e015388c2b10b46b57e&#x27;</span>,</span><br><span class="line">    <span class="attr">blockNumber</span>: <span class="number">11</span>,</span><br><span class="line">    <span class="attr">contractAddress</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">cumulativeGasUsed</span>: <span class="number">29753</span>,</span><br><span class="line">    <span class="attr">effectiveGasPrice</span>: <span class="string">&#x27;0xa32a5d08&#x27;</span>,</span><br><span class="line">    <span class="attr">from</span>: <span class="string">&#x27;0x373241c533af160a2129b4ee784deda383840c52&#x27;</span>,</span><br><span class="line">    <span class="attr">gasUsed</span>: <span class="number">29753</span>,</span><br><span class="line">    <span class="attr">logs</span>: [],</span><br><span class="line">    <span class="attr">logsBloom</span>: <span class="string">&#x27;0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span>,</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">to</span>: <span class="string">&#x27;0x8ded5feb94f27b8dbeef8894100c841e4b8478ea&#x27;</span>,</span><br><span class="line">    <span class="attr">transactionHash</span>: <span class="string">&#x27;0x86248c6f2cbf4ac864087d3cb140d703b3da2ba392791bb040bc5bd23abef3ea&#x27;</span>,</span><br><span class="line">    <span class="attr">transactionIndex</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;0x2&#x27;</span>,</span><br><span class="line">    <span class="attr">rawLogs</span>: []</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">logs</span>: []</span><br><span class="line">&#125;</span><br><span class="line">truffle(development)&gt; ins.get()</span><br><span class="line"><span class="string">&#x27;hello truffle&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="DApp开发"><a href="#DApp开发" class="headerlink" title="DApp开发"></a>DApp开发</h3><p>以上，我们有了一个可供交互的合约，现在我们可以为这个合约开发DApp了。实际上，这个合约已经是EVM上可以执行的去中心应用了，但是这个应用没有界面，我们需要为其制作一个方便用户操作的界面，这里就和<code>web2</code>的开发没有任何区别了。DApp可以是纯web前端的应用，也可以包含一个中心部署的后端，这取决于最终需求，只是一旦包含了中心化部署的后端那么这个DApp就不在是一个纯去中心的应用了，可以算作<code>web2.5</code>。</p>
<p>这里我们会需要用到web3.js这个基础的库。web3.js是什么？答：Ethereum JavaScript API，是一系列合约交互库的集合，支持IPC、HTTP和WebSocket。下面演示一个最基本的<code>web3.js + html</code>的合约调用DApp：</p>
<p>在HTML文件中引入<code>web3.js</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>初始化如下内容：</p>
<ol>
<li>web3 provider：他在DApp中负责与区块链通信，也包括合约调用交互（产品级provider可以选用Metamask）</li>
<li>ABI：合约的方法接口，一般为JSON-RPC Provider提供</li>
<li>合约地址：例子中为0x8DEd5fEb94f27b8DBEeF8894100C841e4b8478Ea</li>
</ol>
<p>完整的测试代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Test Solidity<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input_bar&quot;</span> <span class="attr">name</span>=<span class="string">&quot;input_bar&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Default&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Test Contract&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="comment">// JSON-RPC provider</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> web3 = <span class="keyword">new</span> Web3(<span class="keyword">new</span> Web3.providers.HttpProvider(<span class="string">&quot;http://127.0.0.1:8545&quot;</span>));</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> abi=[</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;constant&quot;</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;inputs&quot;</span>: [</span></span><br><span class="line"><span class="javascript">            &#123;</span></span><br><span class="line"><span class="javascript">              <span class="string">&quot;name&quot;</span>: <span class="string">&quot;_msg&quot;</span>,</span></span><br><span class="line"><span class="javascript">              <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span></span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">          ],</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;name&quot;</span>: <span class="string">&quot;set&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;outputs&quot;</span>: [],</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;payable&quot;</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;nonpayable&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        &#123;</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;constant&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;inputs&quot;</span>: [],</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;outputs&quot;</span>: [</span></span><br><span class="line"><span class="javascript">            &#123;</span></span><br><span class="line"><span class="javascript">              <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="javascript">              <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span></span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">          ],</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;payable&quot;</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;stateMutability&quot;</span>: <span class="string">&quot;view&quot;</span>,</span></span><br><span class="line"><span class="javascript">          <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span></span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">      ]</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> addr=<span class="string">&quot;0x8DEd5fEb94f27b8DBEeF8894100C841e4b8478Ea&quot;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">      <span class="built_in">document</span>.querySelectorAll(<span class="string">&quot;input&quot;</span>)[<span class="number">1</span>].onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> contract = <span class="keyword">new</span> web3.eth.Contract(abi, addr);  <span class="comment">// 基本上常见的eth交互接口都在web3.eth这里</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> text = <span class="built_in">document</span>.getElementById(<span class="string">&quot;input_bar&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 通常对于会改变状态的调用使用send</span></span></span><br><span class="line"><span class="javascript">        contract.methods.set(text).send(&#123;<span class="attr">from</span>: <span class="string">&quot;0x373241c533AF160A2129b4eE784DeDA383840C52&quot;</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, res</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 对于不改变状态的调用使用call</span></span></span><br><span class="line"><span class="javascript">            contract.methods.get().call(<span class="function"><span class="keyword">function</span>(<span class="params">err, res</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">&quot;result&quot;</span>).innerHTML = <span class="string">&quot;call get: &quot;</span> + res;</span></span><br><span class="line"><span class="javascript">            &#125;);  </span></span><br><span class="line"><span class="javascript">        &#125;);</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;result&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/image/truffle/web3js.png" alt="web3.js"></p>
<p>以上，我们将DApp开发中最为核心的合约开发与部署，部署合约的前端交互等两个部分都讲解完了。</p>
<h3 id="使用Dfinity"><a href="#使用Dfinity" class="headerlink" title="使用Dfinity"></a>使用Dfinity</h3><p>Dfinity，有个宏图伟志<a target="_blank" rel="noopener" href="https://dfinity.org/showcase">Internet Computer</a>，不禁让我想起曾经的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/EOS.IO">EOS</a>。同样是依托<a target="_blank" rel="noopener" href="https://webassembly.org/">WASM</a>提供显著优于单纯智能合约的计算能力，但是一个作为L1网络，一个则是基于ETH。上述流程揭露了如果我们要开发一款基于ETH的DApp，不可避免的会存在一定程度上中心化的部分，但是如果我们选择了<code>Dfinity</code>那么，一个「纯」web3 DApp将成为可能。</p>
<p>凭借<code>WASM</code>和<code>Actor Model</code>，我们可以将自己的应用完全部署到Dfinity网络当中，具体请参考官方的整个<a target="_blank" rel="noopener" href="https://internetcomputer.org/docs/current/developer-docs/quickstart/hello10mins">例子</a>。要特别注意到，Dfinity的Smart Contract已经和其DApp有机的融合在一起了，而不是ETH这样需要Provider桥接App和Smart Contract的模式，从技术上讲Difinity这种流程其实更符合一款web3应用的开发过程。</p>
<p><a target="_blank" rel="noopener" href="https://6lqbm-ryaaa-aaaai-qibsa-cai.ic0.app/">Demo</a></p>
<p>我们还需要ETH吗？这个问题的答案还是要看生态，生态和资产是核心，一方面ETH上积累的资产和生态是最多的，另一方面100% on-chain的web3应用从迭代、可维护性和自主性（中心化一定程度上还是有很重要的作用）等方面都值得探讨，所以两者还有很长时间的共存状态。而且当下区块链网络还有诸多的核心痛点需要解决，首当其冲就是Infra实在太匮乏，开发过程也比web2繁琐了很多。而且信息的追踪和索引能力基本没有，如果想做推广，依然得借助web2的平台，庆幸的是已经存在很多类似<code>DMail</code>这样的明星项目了，我们仍然需要web3的Google Search，web3的tiktok，web3的cloud service，web3的Oracle DB等。</p>
<p>千言万语一句话：BUIDL~</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>可以关注的内容：</p>
<ol>
<li>关于<code>DApp</code>开发更加贴近工业规范的内容，推荐guoyu的这篇<a target="_blank" rel="noopener" href="https://guoyu.mirror.xyz/RD-xkpoxasAU7x5MIJmiCX4gll3Cs0pAd5iM258S1Ek">文章</a></li>
<li>Geth和Truffle都不是必须选用的，也可以尝试<code>Hardhat</code>、<code>Ganache</code>等</li>
<li>Truffle官方的<a target="_blank" rel="noopener" href="https://trufflesuite.com/tutorial/">指南</a></li>
<li>尽可能多去查阅web3.js的官方文档</li>
<li>web3.js中call与send的<a target="_blank" rel="noopener" href="https://bitsofco.de/calling-smart-contract-functions-using-web3-js-call-vs-send/">区别</a></li>
<li>真•web3: Difinity</li>
<li><a target="_blank" rel="noopener" href="https://zksync.io/">zkSync</a>: L2 Scaling 解决方案</li>
<li><a target="_blank" rel="noopener" href="https://github.com/orgs/input-output-hk/repositories?language=haskell&type=all">Cardano</a>: 全套基础设施<a target="_blank" rel="noopener" href="https://medium.com/@cardano.foundation/why-cardano-chose-haskell-and-why-you-should-care-why-cardano-chose-haskell-and-why-you-should-f97052db2951">Haskell</a>语言开发的区块链</li>
<li><a target="_blank" rel="noopener" href="https://www.avax.network/">Avalanche</a>: DApp的开发生态目前还很不友好，Avalanche作为一个自称eco-friendly的项目值得了解</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://izhen.me/2022/05/23/2022_DApp/" data-id="cl3il1hro0000nndx08wccvo8" data-title="DApp一日通——web3.js、Truffle与Dfinity篇" class="article-share-link">Share</a>
      
        <a href="https://izhen.me/2022/05/23/2022_DApp/#disqus_thread" class="article-comment-link">Comments</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DApp/" rel="tag">DApp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dfinity/" rel="tag">Dfinity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ethereum/" rel="tag">Ethereum</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Geth/" rel="tag">Geth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Haskell/" rel="tag">Haskell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Solidity/" rel="tag">Solidity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Truffle/" rel="tag">Truffle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web-3-0/" rel="tag">web 3.0</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web3-js/" rel="tag">web3.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/x071/" rel="tag">x071</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2022/05/15/2022_solidity/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">智能合约一日通——Solidity篇</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2009-2022 Zhen Yi<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
      <br>
      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
      <span class="site-uv">用户访问: <span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
      <span class="site-pv">本站访问: <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a target="_blank" rel="noopener" href="http://sweetpotato.ai" class="mobile-nav-link">λ</a>
  
    <a href="/lab" class="mobile-nav-link">About</a>
  
    <a target="_blank" rel="noopener" href="https://resume.izhen.me" class="mobile-nav-link">Resume</a>
  
    <a target="_blank" rel="noopener" href="https://github.com/i-zhen" class="mobile-nav-link">Github</a>
  
</nav>
    
<script>
  var disqus_shortname = 'izhen';
  
  var disqus_url = 'https://izhen.me/2022/05/23/2022_DApp/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>